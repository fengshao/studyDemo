webpackJsonp([8],{211:function(e,t,i){try{(function(){"use strict";function t(){this.generateActions("getShareList","addShare","editShare","showAddFrom","showEditFrom","hideEditFrom"),this.getShareList=function(){var e=this;a.getShareList().then(function(t){e.dispatch(t.data)},function(t){e.dispatch(t)})},this.addShare=function(e){var t=this;a.addShare(e).then(function(e){t.actions.getShareList()},function(e){t.dispatch(e)})},this.editShare=function(e){var t=this;a.editShare(e).then(function(e){t.actions.getShareList()},function(e){t.dispatch(e)})}}var a=i(7);e.exports=alt.createActions(t)}).call(this)}finally{}},467:function(e,t,i){(function(t){try{(function(){"use strict";var a=i(469),r=i(470),s=i(468),n=i(211),o=t.createClass({displayName:"Special",getInitialState:function(){var e=s.getState();return e},onChange:function(){var e=s.getState();this.setState(e)},componentDidMount:function(){s.listen(this.onChange),n.getShareList()},componentWillUnmount:function(){s.unlisten(this.onChange),alt.flush()},events:{addShare:function(e){n.addShare(e)},editShare:function(e){n.editShare(e)},showEditFrom:function(e){n.showEditFrom(e)},showAddFrom:function(){n.showAddFrom()},hideEditFrom:function(){n.hideEditFrom()}},render:function(){return t.createElement("div",null,this.state.isShowEditFrom||this.state.isShowAddFrom?t.createElement(a,{hideEditFrom:this.events.hideEditFrom,addSpecial:this.events.addShare,editSpecial:this.events.editShare,allData:this.state.specialList,editRowData:this.state.editRowData}):t.createElement(r,{showEditFrom:this.events.showEditFrom,showAddFrom:this.events.showAddFrom,editRowData:this.state.shareData}))}});e.exports=o}).call(this)}finally{}}).call(t,i(2))},468:function(e,t,i){try{(function(){"use strict";function t(){this.shareData={id:"",title:"",wechat_circle:"",wechat_friends:"",qq_circle:"",qq_friends:"",img:""},this.editRowData={id:"",title:"",wechat_circle:"",wechat_friends:"",qq_circle:"",qq_friends:"",img:""},this.isShowEditFrom=!1,this.isShowAddFrom=!1,this.bindActions(a)}var a=i(211);t.prototype.getShareList=function(e){this.shareData={id:"",title:"",wechat_circle:"",wechat_friends:"",qq_circle:"",qq_friends:""},this.isShowEditFrom=!1,this.isShowAddFrom=!1,this.shareData=e?e[0]:this.shareData},t.prototype.showEditFrom=function(e){this.editRowData=e,this.isShowEditFrom=!0},t.prototype.showAddFrom=function(){this.editRowData={id:"",title:"",wechat_circle:"",wechat_friends:"",qq_circle:"",qq_friends:"",img:""},this.isShowAddFrom=!0},t.prototype.hideEditFrom=function(){this.editRowData={id:"",title:"",wechat_circle:"",wechat_friends:"",qq_circle:"",qq_friends:"",img:""},this.isShowEditFrom=!1,this.isShowAddFrom=!1},e.exports=alt.createStore(t,"ShareEditStore")}).call(this)}finally{}},469:function(e,t,i){(function(t,a){try{(function(){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(3),n=s.Form.Item,o=i(7),l=t.createClass({displayName:"EditForm",getInitialState:function(){return{imgSrc:this.props.editRowData.img}},componentWillUnmount:function(){a("body").css("overflow","hidden")},componentDidMount:function(){a("body").css("overflow","auto")},checkImgType:function(e,t,i){if(this.state.imgSrc)return void i();if(!t)return void i([new Error("抱歉，请选择png，jpg，jpeg，gif格式的图片上传。")]);var a=t.substr(t.lastIndexOf(".")).toLowerCase();".jpg"!=a&&".png"!=a&&".jpeg"!=a&&".gif"!=a?i([new Error("抱歉，请选择png，jpg，jpeg，gif格式的图片上传。")]):i()},saveSpecial:function(){var e=this,t=this;return this.state.imgSrc||this.props.editRowData.img?void this.props.form.validateFields(function(i,r){r.img=e.state.imgSrc?e.state.imgSrc:e.props.editRowData.img,r.qq_circle=r.wechat_circle,r.qq_friends=r.wechat_friends;var s=!1;a.each(r,function(e,i){i!=t.props.editRowData[e]&&(s=!0)}),!i&&s&&(t.props.editRowData.id?(r.id=t.props.editRowData.id,t.props.editSpecial(r)):t.props.addSpecial(r))}):void s.message.warning("请上传图片")},uploadImage:function(){var e=this,t=new FormData(a("#fileForm")[0]);a.ajax({method:"post",url:o.publicParms.url,data:t,dataType:"JSON",cache:!1,processData:!1,contentType:!1,success:function(t){if(t&&t.result){var i=t.result,a=o.publicParms.httpStr+i.savepath+"/"+i.savename;e.setState({imgSrc:a})}},error:function(e){s.message.error("上传失败")}})},render:function(){var e=this.props.form,i=e.getFieldProps,a=e.getFieldError,o=e.isFieldValidating,l=i("title",{rules:[{required:!0,message:"分享标题不能为空"}],initialValue:this.props.editRowData.title?this.props.editRowData.title:""}),c=i("wechat_friends",{rules:[{required:!0,message:"分享文案不能为空"}],initialValue:this.props.editRowData.wechat_friends?this.props.editRowData.wechat_friends:""}),d=i("wechat_circle",{rules:[{required:!0,message:"分享标题不能为空"}],initialValue:this.props.editRowData.wechat_circle?this.props.editRowData.wechat_circle:""}),h=i("img",{validate:[{rules:[{validator:this.checkImgType}],trigger:["onChange"]}]}),m={labelCol:{span:7},wrapperCol:{span:12}};return t.createElement("div",null,t.createElement("div",{className:"ant-col-4"}),t.createElement("div",{className:"ant-col-13"},t.createElement(s.Form,{horizontal:!0,className:"editform",id:"fileForm"},t.createElement(n,r({label:"专题图片",hasFeedback:!0},m,{help:o("img")?"校验中...":(a("img")||[]).join(", ")}),t.createElement(s.Input,r({},h,{type:"file",id:"file",name:"file",className:"upload-img",accept:"image/png, image/jpg, image/jpeg, image/gif",style:{width:"70%",marginRight:8}})),t.createElement(s.Button,{onClick:this.uploadImage},"上传"))),t.createElement(s.Form,{horizontal:!0,className:"editform"},t.createElement(n,r({},m,{label:"图片预览",hasFeedback:!0}),t.createElement("img",{src:this.state.imgSrc?this.state.imgSrc:this.props.editRowData.imgSrc,className:"preview-img"})),t.createElement("fieldset",{className:"fieldset-cls"},t.createElement("legend",null,"分享给朋友"),t.createElement(n,r({},m,{label:"分享标题",hasFeedback:!0,help:o("title")?"校验中...":(a("title")||[]).join(", ")}),t.createElement(s.Input,r({},l,{placeholder:"请输入分享标题"}))),t.createElement(n,r({},m,{label:"分享描述",hasFeedback:!0,help:o("wechat_friends")?"校验中...":(a("wechat_friends")||[]).join(", ")}),t.createElement(s.Input,r({},c,{placeholder:"请输入分享文案"})))),t.createElement("fieldset",{className:"fieldset-cls"},t.createElement("legend",null,"分享到朋友圈只有标题没有描述"),t.createElement(n,r({},m,{label:"分享标题",hasFeedback:!0,help:o("wechat_circle")?"校验中...":(a("wechat_circle")||[]).join(", ")}),t.createElement(s.Input,r({},d,{placeholder:"请输入分享标题"})))),t.createElement(n,{wrapperCol:{span:12,offset:10}},t.createElement(s.Button,{type:"primary",onClick:this.saveSpecial},"确定"),"   ",t.createElement(s.Button,{type:"ghost",onClick:this.props.hideEditFrom},"返回")))))}});l=s.Form.create()(l),e.exports=l}).call(this)}finally{}}).call(t,i(2),i(4))},470:function(e,t,i){(function(t,a){try{(function(){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},s=i(3),n=s.Form.Item,o=t.createClass({displayName:"ShareInfo",getInitialState:function(){return{}},componentWillUnmount:function(){a("body").css("overflow","hidden")},componentDidMount:function(){a("body").css("overflow","auto")},render:function(){var e={labelCol:{span:7},wrapperCol:{span:12}};return t.createElement("div",null,t.createElement("div",{className:"ant-col-4"}),t.createElement("div",{className:"ant-col-13"},t.createElement(s.Form,{horizontal:!0,className:"editform"},t.createElement(n,{wrapperCol:{span:12,offset:12}},this.props.editRowData.id?"":t.createElement("label",{className:"share-message"},"当前没有分享文案，请添加"),this.props.editRowData.id?t.createElement(s.Button,{className:"share-btn",type:"primary",onClick:this.props.showEditFrom.bind(this,this.props.editRowData)},"编辑"):"",this.props.editRowData.id?"":t.createElement(s.Button,{className:"share-btn",type:"primary",onClick:this.props.showAddFrom},"添加")),t.createElement(n,r({},e,{label:"分享图片",hasFeedback:!0}),t.createElement("img",{src:this.props.editRowData.img,className:"preview-img"})),t.createElement("fieldset",{className:"fieldset-cls"},t.createElement("legend",null,"分享给朋友"),t.createElement(n,r({},e,{label:"分享标题",hasFeedback:!0}),t.createElement("label",null,this.props.editRowData.title)),t.createElement(n,r({},e,{label:"分享描述",hasFeedback:!0}),t.createElement("label",null,this.props.editRowData.wechat_friends))),t.createElement("fieldset",{className:"fieldset-cls"},t.createElement("legend",null,"分享到朋友圈只有标题没有描述"),t.createElement(n,r({},e,{label:"分享标题",hasFeedback:!0}),t.createElement("label",null,this.props.editRowData.wechat_circle))))))}});o=s.Form.create()(o),e.exports=o}).call(this)}finally{}}).call(t,i(2),i(4))}});
//# sourceMappingURL=8.8.afdb0e44ead1932a79ec.d9b30ae8039f742320fb.js.map